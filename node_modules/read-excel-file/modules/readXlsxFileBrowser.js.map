{"version":3,"sources":["../source/readXlsxFileBrowser.js"],"names":["unpackXlsxFile","xml","readXlsx","convertToJson","readXlsxFile","file","options","sheet","then","entries","rows","schema"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,yBAA3B;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;;AAEA;;;;;;;AAOA,eAAe,SAASC,YAAT,CAAsBC,IAAtB,EAA0C;AAAA,KAAdC,OAAc,uEAAJ,EAAI;;AACxD;AACA,KAAI,OAAOA,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAP,KAAmB,QAAtD,EAAgE;AAC/DA,YAAU,EAAEC,OAAOD,OAAT,EAAV;AACA,EAFD,MAEO,IAAI,CAACA,QAAQC,KAAb,EAAoB;AAC1BD,UAAQC,KAAR,GAAgB,CAAhB;AACA;AACD,QAAOP,eAAeK,IAAf,EAAqBC,OAArB,EACLE,IADK,CACA;AAAA,SAAWN,SAASO,OAAT,EAAkBR,GAAlB,EAAuBK,OAAvB,CAAX;AAAA,EADA,EAELE,IAFK,CAEA,UAACE,IAAD,EAAU;AACf,MAAIJ,QAAQK,MAAZ,EAAoB;AACnB,UAAOR,cAAcO,IAAd,EAAoBJ,QAAQK,MAA5B,EAAoCL,OAApC,CAAP;AACA;AACD,SAAOI,IAAP;AACA,EAPK,CAAP;AAQA","file":"readXlsxFileBrowser.js","sourcesContent":["import unpackXlsxFile from './unpackXlsxFileBrowser'\r\nimport xml from './xmlBrowser'\r\nimport readXlsx from './readXlsx'\r\nimport convertToJson from './convertToJson'\r\n\r\n/**\r\n * Reads XLSX file into a 2D array of cells in a browser.\r\n * @param  {file} file - A file being uploaded in the browser.\r\n * @param  {object?} options\r\n * @param  {string?} options.sheet - Excel document sheet to read. Defaults to `1`. Will only read this sheet and skip others.\r\n * @return {Promise} Resolves to a 2D array of cells: an array of rows, each row being an array of cells.\r\n */\r\nexport default function readXlsxFile(file, options = {}) {\r\n\t// Deprecated 1.0.0 `sheet` argument. Will be removed in some next major release.\r\n\tif (typeof options === 'string' || typeof options === 'number') {\r\n\t\toptions = { sheet: options }\r\n\t} else if (!options.sheet) {\r\n\t\toptions.sheet = 1\r\n\t}\r\n\treturn unpackXlsxFile(file, options)\r\n\t\t.then(entries => readXlsx(entries, xml, options))\r\n\t\t.then((rows) => {\r\n\t\t\tif (options.schema) {\r\n\t\t\t\treturn convertToJson(rows, options.schema, options)\r\n\t\t\t}\r\n\t\t\treturn rows\r\n\t\t})\r\n}"]}