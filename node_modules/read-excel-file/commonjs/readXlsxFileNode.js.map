{"version":3,"sources":["../source/readXlsxFileNode.js"],"names":["readXlsxFile","input","options","sheet","then","entries","rows","schema"],"mappings":";;;;;kBAYwBA,Y;;AAZxB;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;AAOe,SAASA,YAAT,CAAsBC,KAAtB,EAA2C;AAAA,KAAdC,OAAc,uEAAJ,EAAI;;AACzD;AACA,KAAI,OAAOA,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAP,KAAmB,QAAtD,EAAgE;AAC/DA,YAAU,EAAEC,OAAOD,OAAT,EAAV;AACA,EAFD,MAEO,IAAI,CAACA,QAAQC,KAAb,EAAoB;AAC1BD,UAAQC,KAAR,GAAgB,CAAhB;AACA;AACD,QAAO,kCAAeF,KAAf,EAAsBC,OAAtB,EACLE,IADK,CACA;AAAA,SAAW,wBAASC,OAAT,iBAAuBH,OAAvB,CAAX;AAAA,EADA,EAELE,IAFK,CAEA,UAACE,IAAD,EAAU;AACf,MAAIJ,QAAQK,MAAZ,EAAoB;AACnB,UAAO,6BAAcD,IAAd,EAAoBJ,QAAQK,MAA5B,EAAoCL,OAApC,CAAP;AACA;AACD,SAAOI,IAAP;AACA,EAPK,CAAP;AAQA","file":"readXlsxFileNode.js","sourcesContent":["import unpackXlsxFile from './unpackXlsxFileNode'\r\nimport xml from './xml'\r\nimport readXlsx from './readXlsx'\r\nimport convertToJson from './convertToJson'\r\n\r\n/**\r\n * Reads XLSX file into a 2D array of cells in a browser.\r\n * @param  {(string|Stream)} input - A Node.js readable stream or a path to a file.\r\n * @param  {object?} options\r\n * @param  {string?} options.sheet - Excel document sheet to read. Defaults to `1`. Will only read this sheet and skip others.\r\n * @return {Promise} Resolves to a 2D array of cells: an array of rows, each row being an array of cells.\r\n */\r\nexport default function readXlsxFile(input, options = {}) {\r\n\t// Deprecated 1.0.0 `sheet` argument. Will be removed in some next major release.\r\n\tif (typeof options === 'string' || typeof options === 'number') {\r\n\t\toptions = { sheet: options }\r\n\t} else if (!options.sheet) {\r\n\t\toptions.sheet = 1\r\n\t}\r\n\treturn unpackXlsxFile(input, options)\r\n\t\t.then(entries => readXlsx(entries, xml, options))\r\n\t\t.then((rows) => {\r\n\t\t\tif (options.schema) {\r\n\t\t\t\treturn convertToJson(rows, options.schema, options)\r\n\t\t\t}\r\n\t\t\treturn rows\r\n\t\t})\r\n}"]}