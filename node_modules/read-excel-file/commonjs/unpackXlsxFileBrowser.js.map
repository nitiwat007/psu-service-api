{"version":3,"sources":["../source/unpackXlsxFileBrowser.js"],"names":["unpackXlsxFile","file","sheet","files","then","zip","forEach","relativePath","zipEntry","name","push","entries","Promise","all","map","async","text"],"mappings":";;;;;kBAWwBA,c;;AAXxB;;AAEA;;AAEA;;;;;;;AAOe,SAASA,cAAT,CAAwBC,IAAxB,QAAyC;AAAA,KAATC,KAAS,QAATA,KAAS;;AACvD,KAAMC,QAAQ,EAAd;;AAEA,QAAO,sBAAUF,IAAV,EAAgBG,IAAhB,CAAqB,UAACC,GAAD,EAAS;AACpC,MAAMF,QAAQ,EAAd;AACAE,MAAIC,OAAJ,CAAY,UAACC,YAAD,EAAeC,QAAf,EAA4B;AACvC,OAAI,0CAAgBA,SAASC,IAAzB,EAA+BP,KAA/B,CAAJ,EAA2C;AAC1CC,UAAMO,IAAN,CAAWF,SAASC,IAApB;AACA;AACD,GAJD;;AAMA,MAAME,UAAU,EAAhB;AACA,SAAOC,QAAQC,GAAR,CAAYV,MAAMW,GAAN,CAAU,UAACb,IAAD,EAAU;AACtC,UAAOI,IAAIJ,IAAJ,CAASA,IAAT,EAAec,KAAf,CAAqB,QAArB,EAA+BX,IAA/B,CAAoC,UAACY,IAAD,EAAU;AACpDL,YAAQ,0CAAgBV,IAAhB,EAAsBC,KAAtB,CAAR,IAAwCc,IAAxC;AACA,IAFM,CAAP;AAGA,GAJkB,CAAZ,EAKNZ,IALM,CAKD;AAAA,UAAM,8CAAoBO,OAApB,EAA6BT,KAA7B,CAAN;AAAA,GALC,CAAP;AAMA,EAfM,CAAP;AAgBA","file":"unpackXlsxFileBrowser.js","sourcesContent":["import { loadAsync } from 'jszip'\r\n\r\nimport { getXlsxEntryKey, validateXlsxEntries } from './readXlsxFileHelpers'\r\n\r\n/**\r\n * Reads XLSX file in a browser.\r\n * @param  {file} file - A file being uploaded in the browser.\r\n * @param  {object} options\r\n * @param  {string?} options.sheet - Excel document sheet to read. Defaults to `1`. Will only read this sheet and skip others.\r\n * @return {Promise} Resolves to an object holding XLSX file entries.\r\n */\r\nexport default function unpackXlsxFile(file, { sheet }) {\r\n\tconst files = {}\r\n\r\n\treturn loadAsync(file).then((zip) => {\r\n\t\tconst files = []\r\n\t\tzip.forEach((relativePath, zipEntry) => {\r\n\t\t\tif (getXlsxEntryKey(zipEntry.name, sheet)) {\r\n\t\t\t\tfiles.push(zipEntry.name)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst entries = {}\r\n\t\treturn Promise.all(files.map((file) => {\r\n\t\t\treturn zip.file(file).async('string').then((text) => {\r\n\t\t\t\tentries[getXlsxEntryKey(file, sheet)] = text\r\n\t\t\t})\r\n\t\t}))\r\n\t\t.then(() => validateXlsxEntries(entries, sheet))\r\n\t})\r\n}"]}